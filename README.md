<h1 align="center">
  <a href="https://npmjs.com/package/admate" target="_blank" rel="noopener noreferrer">
    Admate <sup><img alt="version" src="https://img.shields.io/npm/v/admate.svg?style=flat-square&color=white&label="></sup>
  </a>
</h1>

<p align="center">
  ä¸­åå° CRUD å‰ç«¯å…ƒæ¡†æ¶ï¼Œæè‡´ç®€æ´çš„åŸºç¡€ä¸Šä¸å‘çµæ´»æ€§å¦¥åï¼Œ
  <br>
  è‡´åŠ›äºæ”»å…‹ã€Œé¡µé¢é‡å¤åº¦é«˜ï¼Œæå–å…¬å…±ä»£ç å´éš¾ä»¥å…¼é¡¾å®šåˆ¶åŒ–éœ€æ±‚ã€çš„ç—›ç‚¹ã€‚
</p>

<p align="center">
  <a href="https://www.npmjs.com/package/admate?activeTab=versions"><img alt="created at" src="https://img.shields.io/github/created-at/cloydlau/admate?&color=1C404E&logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNDggNDgiPjxnIGZpbGw9Im5vbmUiPjxwYXRoIGQ9Ik04IDQwaDMyVjI0SDh6Ii8+PHBhdGggc3Ryb2tlPSIjZmZmZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iNCIgZD0iTTQwIDQwSDhtMzIgMEg0aDRtMzIgMGg0bS00IDBWMjRIOHYxNiIvPjxwYXRoIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjQiIGQ9Im00MCAzNGwtNC0ybC00IDJsLTQtMmwtNCAybC00LTJsLTQgMmwtNC0ybC00IDJtMjQtMTB2LTltLTggOXYtOW0tOCA5di05bTE2LTVWOG0tOCAyVjhtLTggMlY4TTggMjR2MTZtMzItMTZ2MTYiLz48L2c+PC9zdmc+"></a>
  <a href="https://github.com/antfu/eslint-config"><img alt="code style" src="https://antfu.me/badge-code-style.svg"></a>
  <a href="https://app.fossa.io/projects/git%2Bgithub.com%2Fcloydlau%2Fadmate?ref=badge_shield&issueType=license" alt="FOSSA Status"><img src="https://app.fossa.io/api/projects/git%2Bgithub.com%2Fcloydlau%2Fadmate.svg?type=shield&issueType=license"/></a>
  <a href="https://bundlephobia.com/package/admate"><img alt="minzipped size" src="https://img.shields.io/bundlephobia/minzip/admate"></a>
  <a href="https://conventionalcommits.org"><img alt="conventional commits" src="https://img.shields.io/badge/commits-Conventional-FE5196.svg?logo=conventionalcommits"></a>
  <a href="https://semantic-release.gitbook.io"><img alt="semantic release" src="https://img.shields.io/badge/release-semantic-e10079?logo=semantic-release"></a>
  <a href="https://pr.new"><img src="https://developer.stackblitz.com/img/start_pr_dark_small.svg" alt="Start new PR in StackBlitz Codeflow"></a>
</p>

<br>

## ç‰¹æ€§

- ğŸ–– **Vue 2.6/2.7/3 ä¸€ä½“é€šç”¨** - é›¶æˆæœ¬å‡çº§
- ğŸ¤¸ **è·¨å¹³å°** - è§£è€¦åˆ UI æ¡†æ¶ï¼Œæä½æˆæœ¬æ¥å…¥ä»»ä½• Vue ç”Ÿæ€ä¸­åå°æ¨¡æ¿/æ¡†æ¶å¦‚ <a href="https://github.com/pure-admin/vue-pure-admin">vue-pure-admin</a>ï¼Œ<a href="https://github.com/vbenjs/vue-vben-admin">vue-vben-admin</a> æˆ– <a href="https://github.com/yudaocode/yudao-ui-admin-vue3">yudao-ui-admin-vue3</a>
- ğŸŒ **è§„æ•´ç»Ÿä¸€çš„é¡µé¢ä»£ç é£æ ¼** - é¿å…å„ä¸ªé¡µé¢çš„ä»£ç é£æ ¼äº”èŠ±å…«é—¨ï¼Œæå‡å¯è¯»æ€§ã€é™ä½ç»´æŠ¤æˆæœ¬
- ğŸ¥¥ **æ¨¡å—çº§åˆ«çš„è¯·æ±‚é…ç½®** - è™½ç„¶ Axios æ”¯æŒå…¨å±€é…ç½®ï¼Œç”±äºåŒæ¨¡å—å†…è¯·æ±‚é…ç½®ç›¸ä¼¼ï¼Œæ¥å£å‰ç¼€é€šå¸¸æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥å¾€å¾€è¿˜éœ€è¦æ¨¡å—çº§åˆ«çš„é…ç½®
- ğŸª **é‡èº«æ‰“é€ çš„ç”Ÿå‘½å‘¨æœŸ** - ä»£ç†æ¨¡å¼ + æ§åˆ¶åè½¬ï¼Œå®šåˆ¶å±äºä½ çš„ç”Ÿå‘½å‘¨æœŸè¡Œä¸º
- ğŸª **è´´å¿ƒè€Œä¸æ­¦æ–­çš„é€»è¾‘å°è£…**
  - åˆ—è¡¨ç­›é€‰ï¼šæ”¯æŒç›‘å¬ç­›é€‰å‚æ•° (é˜²æŠ–æ§åˆ¶æ¥å£è°ƒç”¨é¢‘ç‡) çš„æ–¹å¼ï¼Œä¹Ÿæ”¯æŒç‚¹å‡»è¯»å–æŒ‰é’®è§¦å‘çš„æ–¹å¼
  - è¡¨å•å±•ç°é£æ ¼ï¼šæ”¯æŒå¯¹è¯æ¡†çš„é£æ ¼ï¼Œä¹Ÿæ”¯æŒç‹¬ç«‹é¡µé¢çš„é£æ ¼
  - å•æ¡è®°å½•çŠ¶æ€ï¼šæ”¯æŒè°ƒç”¨ â€œç¼–è¾‘æ¥å£â€ æ”¹å˜çŠ¶æ€ï¼Œä¹Ÿæ”¯æŒè°ƒç”¨ç‹¬ç«‹çš„ â€œæ›´æ–°çŠ¶æ€æ¥å£â€ æŒ‡å®šæ–°çŠ¶æ€ï¼Œä¹Ÿæ”¯æŒåˆ†åˆ«è°ƒç”¨ â€œå¯ç”¨æ¥å£â€ å’Œ â€œåœç”¨æ¥å£â€ æ”¹å˜çŠ¶æ€
  - åŠ è½½çŠ¶æ€ï¼šæä¾›åˆ—è¡¨è¯»å–çŠ¶æ€ã€è¡¨å•è¯»å–çŠ¶æ€ã€è¡¨å•æäº¤çŠ¶æ€çš„å“åº”å¼å˜é‡
- ğŸ§¹ **ç¼œå¯†å‘¨å…¨çš„æ”¶å°¾å·¥ä½œï¼Œæ— åé¡¾ä¹‹å¿§**
  - å…³é—­è¡¨å•æ—¶ï¼Œè‡ªåŠ¨å°†è¡¨å•ç»‘å®šçš„æ•°æ®æ¢å¤è‡³åˆå§‹çŠ¶æ€ (ä¸æ˜¯ç›´æ¥æ¸…ç©º)
  - åˆ é™¤å½“å‰åˆ†é¡µæœ€åä¸€æ¡è®°å½•æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢è‡³ä¸Šä¸€é¡µ (å¦‚æœå½“å‰ä¸åœ¨ç¬¬ä¸€é¡µ)
- ğŸ”Œ **å¼€ç®±å³ç”¨çš„[é€‚é…å±‚ç¤ºä¾‹](https://github.com/cloydlau/admate/blob/main/demo/utils/useAdmateAdapter.js)**
  - åˆ—è¡¨ç­›é€‰å‚æ•°é‡ç½® & å‚æ•°æ ¡éªŒ
  - æ”¯æŒ URL ä¼ å‚æŒ‡å®šç­›é€‰é¡¹é»˜è®¤å€¼
  - æ”¯æŒåŠ¨æ€ç”Ÿæˆç­›é€‰é¡¹é»˜è®¤å€¼ï¼Œä½¿ç”¨åœºæ™¯ä¸¾ä¾‹ï¼šæ—¥æœŸ/æ—¶é—´ç±»çš„å‚æ•°ï¼Œå¦‚æœå…¶é»˜è®¤å€¼ä¸ºå½“å‰æœ€æ–°æ—¶åˆ»ï¼Œé‡ç½®ç­›é€‰é¡¹æ—¶ä¼šé‡ç½®åˆ°å·²è¿‡æœŸçš„æ—¶åˆ»

<br>

## å®‰è£…

```shell
npm i admate
```

### å¤–ç½®ä¾èµ–

- vue
- ~~@vue/composition-api~~ï¼šä»… Vue 2.6 æˆ–æ›´æ—©ç‰ˆæœ¬éœ€è¦

<br>

## è¯·æ±‚é…ç½®

### axios

```ts
useAdmate({
  // Axios æˆ– Axios å®ä¾‹
  // ç”¨äºè°ƒç”¨æ¥å£
  axios,
})
```

<br>

### axiosConfig

```ts
useAdmate({
  // Axios é…ç½®
  axiosConfig: {
    // å„æ¥å£çš„ URL å‰ç¼€
    urlPrefix: `${import.meta.env.VITE_BASE_URL}/module`,
    // åˆ—è¡¨ç›¸å…³æ¥å£
    list: {
      // è¯»å–åˆ—è¡¨
      read: {},
    },
    // è¡¨å•ç›¸å…³æ¥å£
    form: {
      // æ–°å¢
      create: {},
      // è¯»å–
      read: {},
      // ç¼–è¾‘
      update: {},
      // åˆ é™¤
      delete: {},
      // åˆ‡æ¢çŠ¶æ€
      switch: {},
    },
  },
})
```

```ts
// ç¤ºä¾‹: URL å‰ç¼€ä¸ç»Ÿä¸€

useAdmate({
  axiosConfig: {
    urlPrefix: 'module1',
    list: {
      read: {
        // å¦‚æœæŸä¸ªæ¥å£çš„å‰ç¼€ä¸æ˜¯ 'somepage'ï¼Œå¯ä»¥åœ¨ URL å‰é¢åŠ æ–œçº¿ï¼Œå³å¯å¿½ç•¥è¯¥å‰ç¼€
        url: '/module2/selectOne',
      }
    }
  }
})
```

<br>

### RESTful

å¦‚æœæ¥å£åœ°å€éœ€è¦è¿›è¡ŒåŠ¨æ€æ‹¼æ¥

```ts
// é…ç½®
const { list, form } = useAdmate({
  axiosConfig: {
    urlPrefix: `${import.meta.env.VITE_BASE_URL}/module`,
    form: {
      read: ({ id }) => ({
        method: 'GET',
        url: id,
      }),
      update: ({ id }) => ({
        method: 'PUT',
        url: id,
      }),
      delete: ({ id }) => ({
        method: 'DELETE',
        url: id,
      }),
      switch: ({ id }) => ({
        method: 'PUT',
        url: id,
      }),
    },
  }
})

// ä½¿ç”¨
form.open({ id: 1 }, 'config')
form.read({ id: 1 }, 'config')
form.update({ id: 1 }, 'config')
form.delete({ id: 1 }, 'config')
form.switch({ id: 1 }, 'config')
```

<br>

### FormData

`Axios` çš„ data é»˜è®¤ä»¥ `application/json` ä½œä¸º MIME typeï¼Œå¦‚æœä½ éœ€è¦ä½¿ç”¨ `multipart/form-data`ï¼š

- å…¨å±€é…ç½®

ç»™ä½ çš„ `Axios` é…ç½® `transformRequest`ã€`headers['Content-Type']`

- å±€éƒ¨é…ç½®

`list.read`ã€`list.search`ã€`list.reset`ã€`form.open`ã€`form.delete`ã€`form.switch`ã€`form.submit` çš„å‚æ•° 1 å‡æ”¯æŒ FormData ç±»å‹

```vue
<!-- ç¤ºä¾‹: å±€éƒ¨é…ç½® -->

<script setup>
import useAdmateAdapter from '@/utils/useAdmateAdapter'

// è¿‡æ»¤ list.value.filter å¹¶è½¬æ¢ä¸º FormData æ ¼å¼
FormData.from = (json) => {
  const formData = new FormData()
  for (const k in json) {
    if (![Number.NaN, null, undefined].includes(json[k])) {
      formData.append(k, json[k])
    }
  }
  return formData
}

useAdmateAdapter({
  list: {
    proxy: {
      read(readList, trigger) {
        readList(FormData.from(list.value.filter))
      },
    }
  }
})

const FormData = window.FormData
</script>

<template>
  <el-table>
    <el-table-column label="æ“ä½œ">
      <template #default="{ row: { id } }">
        <el-button @click="form.read(FormData.from({ id }))">
          æŸ¥çœ‹
        </el-button>
        <el-button @click="form.update(FormData.from({ id }))">
          ç¼–è¾‘
        </el-button>
        <el-button @click="form.delete(FormData.from({ id }))">
          åˆ é™¤
        </el-button>
      </template>
    </el-table-column>
  </el-table>

  <el-dialog>
    <template #footer>
      <el-button @click="() => form.submit(FormData.from(form.data))">
        ç¡® å®š
      </el-button>
    </template>
  </el-dialog>
</template>
```

<br>

## åˆ—è¡¨

### ç­›é€‰å‚æ•°

`list.filter`

```ts
useAdmate({
  list: {
    // é¡µç çš„å‚æ•°åç§°æˆ–è·¯å¾„ï¼Œå¿…å¡«
    // æ”¯æŒå±æ€§åï¼Œå¦‚ `'pageNo'`
    // æ”¯æŒå±æ€§è·¯å¾„ï¼Œå¦‚ `'page.pageNo'`
    pageNumberAt: undefined,

    // å¯ä»¥åœ¨è¿™é‡Œæä¾›ç­›é€‰å‚æ•°çš„é»˜è®¤å€¼
    filter: {
      'pageNumberAt ç”Ÿæˆçš„é¡µç å‚æ•°åç§°': 1
    },
  },
})
```

<br>

### è§¦å‘è¯»å–

- ç‚¹å‡»ä¸“ç”¨çš„è¯»å–æŒ‰é’®è§¦å‘
  - âœ— æ“ä½œç›¸å¯¹ç¹çã€‚
  - âœ— åˆ—è¡¨æ•°æ®ä¸ç­›é€‰æ¡ä»¶å¯èƒ½æ˜¯æ— å…³çš„ã€‚å¯èƒ½äº§ç”Ÿ â€œå½“å‰çš„åˆ—è¡¨æ•°æ®æ˜¯å¦åŸºäºç­›é€‰é¡¹ï¼Ÿâ€ çš„é¡¾è™‘ï¼Œå¯¼è‡´å¾’å¢ç‚¹å‡»è¯»å–æŒ‰é’®çš„æ¬¡æ•°ã€‚
  - âœ“ æƒ³åŒæ—¶è®¾ç½®å¤šä¸ªç­›é€‰æ¡ä»¶æ—¶ï¼Œåªè°ƒç”¨ä¸€æ¬¡æ¥å£ï¼Œä¸æµªè´¹æœåŠ¡å™¨èµ„æºã€‚

```ts
useAdmate({
  list: {
    watchFilter: false,
  }
})
```

<hr>

- **æ”¹å˜ç­›é€‰æ¡ä»¶åå³æ—¶è§¦å‘**
  - âœ“ æ“ä½œç›¸å¯¹ç®€ä¾¿ã€‚
  - âœ“ åˆ—è¡¨æ•°æ®ä¸ç­›é€‰æ¡ä»¶å³æ—¶ç»‘å®šã€‚
  - âœ“ ~~æƒ³åŒæ—¶è®¾ç½®å¤šä¸ªç­›é€‰æ¡ä»¶æ—¶ï¼Œæ¥å£ä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œæµªè´¹æœåŠ¡å™¨èµ„æº~~ (Admate å·²ä¼˜åŒ–)ã€‚

```ts
useAdmate({
  list: {
    watchFilter: true, // é»˜è®¤å€¼

    // é˜²æŠ–é—´éš”ï¼Œå•ä½æ¯«ç§’
    // å¦‚æœç­›é€‰å‚æ•°ä¸å« input ç±»å‹ï¼Œå¯ä»¥è®¾ç½®ä¸º 0ï¼Œå³ä¸é˜²æŠ–
    // ç¿»é¡µä¸ä¼šè§¦å‘é˜²æŠ–
    // watchFilter å¼€å¯æ—¶æœ‰æ•ˆ
    debounce: 300, // é»˜è®¤å€¼
  }
})
```

<br>

### åˆ—è¡¨æ•°æ®

`list.data`

```ts
useAdmate({
  list: {
    // åˆ—è¡¨æ•°æ®
    data: [],

    // æŒ‡å®šæ¥å£è¿”å›å€¼ä¸­åˆ—è¡¨æ•°æ®çš„ä½ç½®
    // æ”¯æŒå±æ€§åï¼Œå¦‚ `'data'`
    // æ”¯æŒå±æ€§è·¯å¾„ï¼Œå¦‚ `'data[0].records'`
    // æ”¯æŒ symbol ç±»å‹çš„å±æ€§å
    // æ”¯æŒ Functionï¼Œå¦‚ `response => response.data`
    dataAt: undefined,

    // æŒ‡å®šæ¥å£è¿”å›å€¼ä¸­è®°å½•æ€»æ•°çš„ä½ç½®
    // æ”¯æŒå±æ€§åï¼Œå¦‚ `'total'`
    // æ”¯æŒå±æ€§è·¯å¾„ï¼Œå¦‚ `'data[0].total'`
    // æ”¯æŒ symbol ç±»å‹çš„å±æ€§å
    // æ”¯æŒ Functionï¼Œå¦‚ `response => response.total`
    totalAt: undefined,
  }
})
```

<br>

### è¯»å–åˆ—è¡¨

#### list.read

è¯»å–åˆ—è¡¨ï¼Œåœ¨é¦–æ¬¡è¿›å…¥é¡µé¢ã€åˆ—è¡¨ç­›é€‰å‚æ•°æ”¹å˜ã€å•æ¡è®°å½•å¢åˆ æŸ¥æ”¹åä¼šè¢«è°ƒç”¨

```ts
const { list } = useAdmate()

/**
 * PS: ä»¥ä¸‹ä¸ºåŸå§‹å‡½æ•°ç­¾åï¼Œå¦‚æœä½ é…ç½®äº† list.proxy.read ï¼Œåˆ™ä»¥ list.proxy.read ä¸ºå‡†
 *
 * @param {any} [payload = list.filter]
 * @param {'data'|'params'|'config'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 * @returns {Promise<any>} æ¥å£è¿”å›å€¼
 */
list.read() // æ‰‹åŠ¨è¯»å–
```

#### list.search

é‡ç½®é¡µç åæ‰§è¡Œ `list.read` ï¼Œç”¨äºç­›é€‰æ¡ä»¶æ”¹å˜åæ£€ç´¢åˆ—è¡¨

```ts
const { list } = useAdmate()

/**
 * PS: ä»¥ä¸‹ä¸ºåŸå§‹å‡½æ•°ç­¾åï¼Œå¦‚æœä½ é…ç½®äº† list.proxy.read ï¼Œåˆ™ä»¥ list.proxy.read ä¸ºå‡†
 *
 * @param {any} [payload = list.filter]
 * @param {'data'|'params'|'config'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 * @returns {Promise<any>} æ¥å£è¿”å›å€¼
 */
list.search() // æ‰‹åŠ¨æ£€ç´¢
```

#### list.reset

é‡ç½®ç­›é€‰æ¡ä»¶åæ‰§è¡Œ `list.read`

```ts
const { list } = useAdmate()

/**
 * PS: ä»¥ä¸‹ä¸ºåŸå§‹å‡½æ•°ç­¾åï¼Œå¦‚æœä½ é…ç½®äº† list.proxy.reset ï¼Œåˆ™ä»¥ list.proxy.reset ä¸ºå‡†
 *
 * @param {any} [payload = list.filter]
 * @param {'data'|'params'|'config'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 * @returns {Promise<any>} æ¥å£è¿”å›å€¼
 */
list.reset() // æ‰‹åŠ¨é‡ç½®
```

#### list.proxy.read

ä½ å¯ä»¥ä½¿ç”¨ `list.proxy.read` æ¥ä»£ç† `list.read`ï¼Œä»¥ä¾¿åœ¨ `list.read` å‰åæ‰§è¡Œä¸€äº›æ“ä½œï¼Œæˆ–æ”¹å˜ `list.read` çš„è¡Œä¸º

```ts
useAdmate({
  list: {
    proxy: {
      /**
       * @param {Function} readList è¢«ä»£ç†çš„åŸå§‹ readList
       * @param {string} trigger è°ƒç”¨åŠ¨æœº å¯èƒ½çš„å€¼: 'immediate' 'pageNumberChange' 'filterChange' 'create' 'read' 'update' 'delete' 'switch'
       */
      read(readList, trigger) {},
    },
  },
})
```

```ts
// ç¤ºä¾‹: è¯»å–åˆ—è¡¨ä¹‹å‰ï¼Œæ ¡éªŒå‚æ•°

useAdmate({
  list: {
    proxy: {
      read(readList, trigger) {
        if (trigger === 'filterChange') {
          listFilterRef.value.validate().then(() => {
            readList()
          })
        }
        else {
          readList()
        }
      },
    }
  }
})
```

```ts
// ç¤ºä¾‹: å•æ¡è®°å½•æ“ä½œæˆåŠŸåï¼Œå¼¹å‡ºæç¤º

useAdmate({
  list: {
    proxy: {
      read(readList, trigger) {
        readList()
        if (['create', 'upadte', 'delete', 'switch'].includes(trigger)) {
          currentInstance.value.$message.success('æ“ä½œæˆåŠŸ')
        }
      },
    }
  }
})
```

```ts
// ç¤ºä¾‹: è¯»å–åˆ—è¡¨åï¼Œä¿®æ”¹åˆ—è¡¨æ•°æ®

const { list } = useAdmate({
  list: {
    proxy: {
      read(readList, trigger) {
        readList().then((response) => {
          // response ä¸º axiosConfig.list.read çš„æ¥å£è¿”å›å€¼
          list.data = response.data?.filter(v => !v.disabled)
        })
      },
    }
  }
})
```

#### list.proxy.reset

ä½ å¯ä»¥ä½¿ç”¨ `list.proxy.reset` æ¥ä»£ç† `list.reset`ï¼Œä»¥ä¾¿åœ¨ `list.reset` å‰åæ‰§è¡Œä¸€äº›æ“ä½œï¼Œæˆ–æ”¹å˜ `list.reset` çš„è¡Œä¸º

```ts
useAdmate({
  list: {
    proxy: {
      /**
       * @param {Function} resetList è¢«ä»£ç†çš„åŸå§‹ resetList
       */
      reset(resetList) {},
    },
  },
})
```

```ts
// ç¤ºä¾‹: ä½¿ç”¨ UI ç»„ä»¶åº“çš„è¡¨å•é‡ç½®å‡½æ•°æ¥é‡ç½®ç­›é€‰æ¡ä»¶

useAdmate({
  list: {
    proxy: {
      reset(resetList) {
        listFilterElFormRef.value.resetFields()
        // å¦‚æœåˆ†é¡µç»„ä»¶ä¸å½’å±äºè¡¨å•ï¼Œåˆ™è¡¨å•é‡ç½®æ—¶é¡µç ä¸ä¼šè¢«é‡ç½®ï¼Œéœ€è°ƒç”¨ list.search
        if (!list.watchFilter) {
          list.search()
        }
      },
    }
  }
})
```

<br>

### è¯»å–çŠ¶æ€

`list.loading`

`axiosConfig.list.read` è¢«è°ƒç”¨æ—¶å€¼ä¸º `true`ï¼Œå¦åˆ™ä¸º `false`

```vue
<!-- ç¤ºä¾‹ -->

<script setup>
import useAdmate from 'admate'
import { getCurrentInstance } from 'vue'

const { proxy } = getCurrentInstance()
const { list } = useAdmate()

function handleTable() {
  list.value.loading = true
  proxy.$POST('').finally(() => {
    list.value.loading = false
  })
}
</script>

<template>
  <el-table v-loading="list.loading" />
</template>
```

<br>

<a name="form.open-create"></a>

## è¡¨å•

### è¡¨å•é£æ ¼

è¡¨å•é»˜è®¤æ˜¯å¯¹è¯æ¡†/æŠ½å±‰çš„é£æ ¼ï¼Œä½†ä¹Ÿæ”¯æŒ[ç‹¬ç«‹é¡µé¢](#FormDecoupled)çš„é£æ ¼

å¯¹æ¯”

- å¯¹è¯æ¡†/æŠ½å±‰ï¼šä½“éªŒå¥½ï¼Œå‰²è£‚æ„Ÿä½ï¼Œè¡¨å•çš„å¼€é—­ä¸å½±å“çˆ¶é¡µé¢çŠ¶æ€
- ç‹¬ç«‹é¡µé¢ï¼šä½“éªŒè¾ƒå·®ï¼Œä»è¡¨å•è¿”å›çˆ¶é¡µé¢æ—¶ï¼Œçˆ¶é¡µé¢çš„çŠ¶æ€ä¼šä¸¢å¤±ï¼Œæ¯”å¦‚åˆ—è¡¨ç­›é€‰çŠ¶æ€

<br>

### è¡¨å•æ˜¾éš

`form.show: boolean`

<br>

### è¡¨å•æ•°æ®

`form.data`

```ts
useAdmate({
  form: {
    // å¯ä»¥åœ¨è¿™é‡Œæä¾›è¡¨å•æ•°æ®çš„é»˜è®¤å€¼
    data: {},

    // åœ¨æŸ¥çœ‹ã€ç¼–è¾‘è¡¨å•æ—¶ï¼Œå¯èƒ½éœ€è¦è°ƒç”¨æ¥å£ï¼ˆaxiosConfig.form.readï¼‰å›æ˜¾è¡¨å•çš„æ•°æ®
    // dataAt ç”¨äºæŒ‡å®šæ¥å£è¿”å›å€¼ä¸­è¡¨å•æ•°æ®çš„ä½ç½®
    // æ”¯æŒå±æ€§åï¼Œå¦‚ `'detail'`
    // æ”¯æŒå±æ€§è·¯å¾„ï¼Œå¦‚ `'data[0].detail'`
    // æ”¯æŒ symbol ç±»å‹çš„å±æ€§å
    // æ”¯æŒ Functionï¼Œå¦‚ `response => response.detail`
    dataAt: undefined,

    // æ¥å£ï¼ˆaxiosConfig.form.readï¼‰è¿”å›å€¼ä¸ form.data åˆå¹¶çš„æ–¹å¼
    mergeData: 'deep',
  },
})
```

**mergeDataï¼š**

- `'deep'`ï¼šæ·±åˆå¹¶ (é»˜è®¤)
- `'shallow'`ï¼šæµ…åˆå¹¶
- `(newFormData: any) => any`ï¼šè‡ªå®šä¹‰åˆå¹¶æ–¹å¼
- `false`ï¼šä¸åˆå¹¶ï¼Œç›´æ¥æ›¿æ¢

**ä¸ºä»€ä¹ˆé»˜è®¤æ˜¯æ·±åˆå¹¶ï¼Ÿ**

åœ¨ Vue 2 ä¸­ï¼Œtemplate ä¸æ”¯æŒ `?.` è¯­æ³•ï¼Œè¦åœ¨ template ä¸­åˆ¤ç©ºï¼Œä»£ç å†™èµ·æ¥ä¼šéå¸¸å†—ä½™ï¼Œé€šå¸¸çš„åšæ³•æ˜¯åœ¨ data ä¸­å£°æ˜ç©ºå¯¹è±¡

æ¯”å¦‚ç»™ form.data æä¾›é»˜è®¤å€¼ï¼š

```vue
<script setup>
import useAdmate from 'admate'

const { form } = useAdmate({
  form: {
    data: {
      a: {
        b: {}
      }
    }
  }
})
</script>

<template>
  {{ form.data.a.b.c }}
</template>
```

å¦‚æœ axiosConfig.form.read çš„è¿”å›å€¼ä¸ºï¼š
`{ a: {} }`

å¦‚æœä¸é»˜è®¤å€¼<span style="color:red">æµ…åˆå¹¶</span>åå°†å¾—åˆ°ï¼š
`{ a: {} }` â€”â€” é»˜è®¤å€¼ä¸­çš„å¯¹è±¡ b ä¸¢å¤±äº†ï¼Œå¼•å‘ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚

å¦‚æœä¸é»˜è®¤å€¼<span style="color:red">æ·±åˆå¹¶</span>åå°†å¾—åˆ°ï¼š
`{ a: { b: {} } }` â€”â€” ä»£ç æ­£å¸¸å·¥ä½œã€‚

```ts
// ç¤ºä¾‹: è‡ªå®šä¹‰åˆå¹¶æ–¹å¼

import { mergeWith } from 'lodash'

function defaultFormData() {
  return {
    a: {
      b: {}
    }
  }
}

const { form } = useAdmate({
  form: {
    data: defaultFormData(),
    // æ¥å£è¿”å›å€¼ä¸­åµŒå¥—çš„å¯¹è±¡å¯èƒ½ä¸º nullï¼Œä¼šè¦†ç›–é»˜è®¤å€¼ä¸­çš„ç©ºå¯¹è±¡
    mergeData(
      // æ¥å£è¿”å›å€¼åœ¨é€šè¿‡ form.dataAt è®¡ç®—è¿‡åçš„å€¼
      newFormData
    ) {
      // Vue 3 ä¸­ä¸éœ€è¦èµ‹å€¼ï¼ŒmergeWith çš„æ”¹åŠ¨æ˜¯å“åº”å¼çš„
      form.data = mergeWith(
        defaultFormData(),
        newFormData,
        (oldObj, newObj) => [undefined, null].includes(newObj) ? oldObj : undefined
      )
    },
  },
})
```

<br>

### è¡¨å•å½¢æ€

`form.status: 'create' | 'read' | 'update'`

<br>

### è¡¨å•æ ‡é¢˜

`form.title: string`

```ts
// ç¤ºä¾‹: æ ¹æ®è¡¨æ€å½¢æ€ç”Ÿæˆå¯¹åº”çš„æ ‡é¢˜

import { computed } from 'vue'

const { form } = useAdmate({
  form: {
    title: computed(() => ({ create: 'æ–°å¢', read: 'æŸ¥çœ‹', update: 'ç¼–è¾‘' }[form.status])),
  },
})
```

<br>

### æ–°å¢

æ‰“å¼€è¡¨å•ï¼Œæäº¤æ—¶ä¼šè°ƒç”¨ `axiosConfig.form.create`

```ts
const { form } = useAdmate()

form.create()

// ç­‰ä»·äºï¼šå°†è¡¨å•å½¢æ€è®¾ç½®ä¸ºâ€œæ–°å¢â€ï¼Œç„¶åæ‰“å¼€è¡¨å•
form.status = 'create'
form.open()
```

<br>

### å¤åˆ¶æ–°å¢

> è¡¨å•çš„åˆå§‹æ•°æ®ä¸æ˜¯ç©ºç™½ï¼Œè€Œæ˜¯å¤åˆ¶ä¸€æ¡å·²æœ‰çš„è®°å½•

1. æ‰“å¼€è¡¨å•æ—¶ï¼Œå’ŒæŸ¥çœ‹/ç¼–è¾‘ä¸€æ ·ï¼Œéœ€è¦è°ƒæ¥å£å›æ˜¾
2. æäº¤è¡¨å•æ—¶è°ƒç”¨çš„æ˜¯æ–°å¢çš„æ¥å£

```ts
const { form } = useAdmate()

form.create(row)

// ç­‰ä»·äºï¼šå°†è¡¨å•å½¢æ€è®¾ç½®ä¸ºâ€œæ–°å¢â€ï¼Œç„¶åæ‰“å¼€è¡¨å•å¹¶ä¼ å‚
form.status = 'create'
form.open(row)
```

<br>

<a name="form.open-read"></a>

### æŸ¥çœ‹

æ‰“å¼€è¡¨å•ï¼Œå¹¶è°ƒç”¨ `axiosConfig.form.read` å›æ˜¾è¡¨å•å†…å®¹

```ts
const { form } = useAdmate()

form.read()

// ç­‰ä»·äºï¼šå°†è¡¨å•å½¢æ€è®¾ç½®ä¸ºâ€œæŸ¥çœ‹â€ï¼Œç„¶åæ‰“å¼€è¡¨å•
form.status = 'read'
/**
 * PS: ä»¥ä¸‹ä¸ºåŸå§‹ openForm çš„å‡½æ•°ç­¾åï¼Œå¦‚æœä½ é…ç½®äº† form.proxy.open ï¼Œåˆ™ä»¥ form.proxy.open ä¸ºå‡†
 *
 * @param {any} [payload] å¦‚æœ payload ä¸ä¸ºç©ºï¼Œåˆ™ä¼šè°ƒç”¨ axiosConfig.form.read
 * @param {'data'|'params'|'config'|'cache'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 *   'data': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `data` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º POST / PATCH / PUT / DELETE æ—¶é»˜è®¤ï¼‰
 *   'params': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `params` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º GET / HEAD æ—¶é»˜è®¤ï¼‰
 *   'config': å°† payload ä»…ç”¨äºæ„å»ºè¯·æ±‚é…ç½®ï¼ˆè¯¦è§ RESTful ç« èŠ‚ï¼‰
 *   'cache': å°† payload ç›´æ¥ç”¨ä½œè¡¨å•æ•°æ®ï¼ˆä¸è°ƒç”¨è¯»å–å•æ¡è®°å½•çš„æ¥å£ï¼‰
 * @returns {Promise<any>} axiosConfig.form.read çš„è¿”å›å€¼
 */
form.open()
```

<br>

<a name="form.open-update"></a>

### ç¼–è¾‘

æ‰“å¼€è¡¨å•ï¼Œå¹¶è°ƒç”¨ `axiosConfig.form.read` å›æ˜¾è¡¨å•å†…å®¹ï¼Œæäº¤æ—¶ä¼šè°ƒç”¨ `axiosConfig.form.update`

```ts
const { form } = useAdmate()

form.update()

// ç­‰ä»·äºï¼šå°†è¡¨å•å½¢æ€è®¾ç½®ä¸ºâ€œç¼–è¾‘â€ï¼Œç„¶åæ‰“å¼€è¡¨å•
form.status = 'update'
/**
 * PS: ä»¥ä¸‹ä¸ºåŸå§‹ form.open çš„å‡½æ•°ç­¾åï¼Œå¦‚æœä½ é…ç½®äº† form.proxy.open ï¼Œåˆ™ä»¥ form.proxy.open ä¸ºå‡†
 *
 * @param {any} [payload] å¦‚æœ payload ä¸ä¸ºç©ºï¼Œåˆ™ä¼šè°ƒç”¨ axiosConfig.form.read
 * @param {'data'|'params'|'config'|'cache'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 *   'data': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `data` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º POST / PATCH / PUT / DELETE æ—¶é»˜è®¤ï¼‰
 *   'params': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `params` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º GET / HEAD æ—¶é»˜è®¤ï¼‰
 *   'config': å°† payload ä»…ç”¨äºæ„å»ºè¯·æ±‚é…ç½®ï¼ˆè¯¦è§ RESTful ç« èŠ‚ï¼‰
 *   'cache': å°† payload ç›´æ¥ç”¨ä½œè¡¨å•æ•°æ®ï¼ˆä¸è°ƒç”¨è¯»å–å•æ¡è®°å½•çš„æ¥å£ï¼‰
 * @returns {Promise<any>} axiosConfig.form.read çš„è¿”å›å€¼
 */
form.open()
```

<br>

### åˆ é™¤

```ts
const { form } = useAdmate()

/**
 * @param {any} [payload]
 * @param {'data'|'params'|'config'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 *   'data': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `data` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º POST / PATCH / PUT / DELETE æ—¶é»˜è®¤ï¼‰
 *   'params': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `params` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º GET / HEAD æ—¶é»˜è®¤ï¼‰
 *   'config': å°† payload ä»…ç”¨äºæ„å»ºè¯·æ±‚é…ç½®ï¼ˆè¯¦è§ RESTful ç« èŠ‚ï¼‰
 * @returns {Promise<any>} axiosConfig.form.delete çš„è¿”å›å€¼
 */
form.delete()
```

<br>

### çŠ¶æ€å˜æ›´

çŠ¶æ€å˜æ›´æœ‰ä¸‰ç§æ–¹å¼ï¼š

1. åç«¯æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œä¼ å‚æŒ‡å®šæ–°çš„çŠ¶æ€

```vue
<script setup>
import useAdmate from 'admate'

const { form } = useAdmate()

/**
 * @param {any} [payload]
 * @param {'data'|'params'|'config'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 *   'data': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `data` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º POST / PATCH / PUT / DELETE æ—¶é»˜è®¤ï¼‰
 *   'params': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `params` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º GET / HEAD æ—¶é»˜è®¤ï¼‰
 *   'config': å°† payload ä»…ç”¨äºæ„å»ºè¯·æ±‚é…ç½®ï¼ˆè¯¦è§ RESTful ç« èŠ‚ï¼‰
 * @returns {Promise<any>} axiosConfig.form.switch çš„è¿”å›å€¼
 */
form.switch()
</script>

<template>
  <el-table>
    <el-table-column
      label="æ“ä½œ"
      align="center"
    >
      <template #default="{ row: { id, status } }">
        <el-switch @change="form.switch({ id, status: status ^ 1 })" />
      </template>
    </el-table-column>
  </el-table>
</template>
```

2. åç«¯æä¾›å¯ç”¨å’Œåœç”¨ä¸¤ä¸ªæ¥å£

```vue
<script setup>
import useAdmate from 'admate'

const { form } = useAdmate({
  axiosConfig: {
    form: {
      switch: ({ id, status }) => ({
        method: 'PUT',
        url: `${status === 1 ? 'enable' : `disable`}/${id}`,
      }),
    }
  },
})

/**
 * @param {any} [payload]
 * @param {'data'|'params'|'config'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 *   'data': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `data` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º POST / PATCH / PUT / DELETE æ—¶é»˜è®¤ï¼‰
 *   'params': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `params` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º GET / HEAD æ—¶é»˜è®¤ï¼‰
 *   'config': å°† payload ä»…ç”¨äºæ„å»ºè¯·æ±‚é…ç½®ï¼ˆè¯¦è§ RESTful ç« èŠ‚ï¼‰
 * @returns {Promise<any>} axiosConfig.form.switch çš„è¿”å›å€¼
 */
form.switch()
</script>

<template>
  <el-table>
    <el-table-column
      label="æ“ä½œ"
      align="center"
    >
      <template #default="{ row: { id, status } }">
        <el-switch @change="form.switch({ id, status: status ^ 1 }, 'config')" />
      </template>
    </el-table-column>
  </el-table>
</template>
```

3. åç«¯æœªæä¾›ç‹¬ç«‹çš„æ¥å£ï¼Œä½¿ç”¨ç¼–è¾‘æ¥å£æ”¹å˜çŠ¶æ€

```vue
<script setup>
import useAdmate from 'admate'

const { form } = useAdmate({
  axiosConfig: {
    form: {
      update: {
        // ...
      },
      switch: {
        // æŒ‰ç¼–è¾‘æ¥å£è¿›è¡Œé…ç½®
      },
    }
  },
})

/**
 * @param {any} [payload]
 * @param {'data'|'params'|'config'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 *   'data': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `data` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º POST / PATCH / PUT / DELETE æ—¶é»˜ è®¤ï¼‰
 *   'params': å°† payload ç”¨ä½œè¯·æ±‚é…ç½®çš„ `params` å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ä¸º GET / HEAD æ—¶é»˜è®¤ï¼‰
 *   'config': å°† payload ä»…ç”¨äºæ„å»ºè¯·æ±‚é…ç½®ï¼ˆè¯¦è§ RESTful ç« èŠ‚ï¼‰
 * @returns {Promise<any>} axiosConfig.form.switch çš„è¿”å›å€¼
 */
form.switch()
</script>

<template>
  <el-table>
    <el-table-column
      label="æ“ä½œ"
      align="center"
    >
      <template #default="{ row }">
        <el-switch @change="form.switch({ ...row, status: row.status ^ 1 })" />
      </template>
    </el-table-column>
  </el-table>
</template>
```

<br>

### æ‰“å¼€è¡¨å•

#### form.open

æ‰“å¼€è¡¨å•ï¼Œå‡½æ•°ç­¾åè¦åˆ†æƒ…å†µï¼š

- [æ–°å¢æ—¶](#form.open-create)
- [æŸ¥çœ‹æ—¶](#form.open-read)
- [ç¼–è¾‘æ—¶](#form.open-update)

#### form.proxy.open

ä½ å¯ä»¥ä½¿ç”¨ `form.proxy.open` æ¥ä»£ç† `form.open`ï¼Œä»¥ä¾¿åœ¨ `form.open` å‰åæ‰§è¡Œä¸€äº›æ“ä½œï¼Œæˆ–æ”¹å˜ `form.open` çš„è¡Œä¸º

```ts
useAdmate({
  form: {
    proxy: {
      /**
       * @param {Function} openForm è¢«ä»£ç†çš„åŸå§‹ openForm
       * @returns {Promise<object> | object | void} object ä¸ºæ‰“å¼€è¡¨å•å form çš„ç»ˆæ€
       */
      open(openForm) {},
    }
  }
})
```

```ts
// ç¤ºä¾‹: å›æ˜¾è¡¨å•åï¼Œä¿®æ”¹è¡¨å•æ•°æ®

const { form } = useAdmate({
  form: {
    proxy: {
      open(openForm) {
        // æ–°å¢æ—¶ openForm æ²¡æœ‰è¿”å›å€¼
        return new Promise((resolve, reject) => {
          openForm()?.then((response) => {
            // response ä¸º axiosConfig.r çš„æ¥å£è¿”å›å€¼
            // ä¿®æ”¹è¡¨å•æ•°æ®
            form.data.status = 1
            resolve()
          }).catch((e) => {
            reject(e)
          })
        })
      },
    }
  }
})
```

```ts
// ç¤ºä¾‹: å›æ˜¾è¡¨å•åï¼Œæ¸…é™¤æ ¡éªŒ

useAdmate({
  form: {
    proxy: {
      open(openForm) {
        return new Promise((resolve, reject) => {
          openForm()?.finally(() => {
            formRef.value.clearValidate()
          }).then(() => {
            resolve()
          }).catch((e) => {
            reject(e)
          })
        })
      },
    }
  }
})
```

```ts
// ç¤ºä¾‹: å›æ˜¾è¡¨å•åï¼Œè‡ªå®šä¹‰è¡¨å•çš„å¼€é—­å’Œè¯»å–çŠ¶æ€
useAdmate({
  form: {
    proxy: {
      open(openForm) {
        return new Promise((resolve, reject) => {
          // å¯ä»¥åœ¨ finally ä¸­ resolve
          openForm().then(() => {
            // å›æ˜¾æˆåŠŸåï¼Œé»˜è®¤åœæ­¢åŠ è½½
            resolve({
              loading: false,
            })
          }).catch(() => {
            // å›æ˜¾å¤±è´¥åï¼Œé»˜è®¤å…³é—­è¡¨å•å¹¶åœæ­¢åŠ è½½
            resolve({
              show: false,
              loading: false,
            })
          })
        })
      }
    }
  }
})

// ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ˆå¦‚æœæ²¡æœ‰å¼‚æ­¥æ“ä½œï¼‰
useAdmate({
  form: {
    proxy: {
      open(openForm) {
        return {
          loading: false
        }
      }
    }
  }
})
```

<br>

### è¯»å–çŠ¶æ€

`form.loading`

`axiosConfig.form.read` è¢«è°ƒç”¨æ—¶å€¼ä¸º `true`ï¼Œå¦åˆ™ä¸º `false`

> ä¸èƒ½å°†è¯¥å€¼å½“ä½œè¡¨å•å›æ˜¾ç»“æŸçš„æ ‡å¿—ï¼Œå› ä¸ºå¤ç”¨åˆ—è¡¨æ•°æ®æ—¶ä¸ä¼šè°ƒç”¨ axiosConfig.r

```vue
<!-- ç¤ºä¾‹ -->

<script setup>
import useAdmate from 'admate'

const { form } = useAdmate()
</script>

<template>
  <el-dialog>
    <el-form v-loading="form.loading" />
  </el-dialog>
</template>
```

<br>

### æäº¤è¡¨å•

#### form.submit

æäº¤è¡¨å•ï¼Œæ–°å¢æ—¶è°ƒç”¨ `axiosConfig.form.create`ï¼Œç¼–è¾‘æ—¶è°ƒç”¨ `axiosConfig.form.update`

```ts
const { form } = useAdmate()

/**
 * PS: ä»¥ä¸‹ä¸ºåŸå§‹ form.submit çš„å‡½æ•°ç­¾åï¼Œå¦‚æœä½ é…ç½®äº† form.proxy.submit ï¼Œåˆ™ä»¥ form.proxy.submit ä¸ºå‡†
 *
 * @param {any} [payload = form.data]
 * @param {'data'|'params'|'config'} [payloadAs] æŒ‡å®š payload çš„ç”¨é€”
 * @returns {Promise<any>} æ¥å£è¿”å›å€¼
 */
form.submit()
```

#### form.proxy.submit

ä½ å¯ä»¥ä½¿ç”¨ `form.proxy.submit` æ¥ä»£ç† `form.submit` ï¼Œä»¥ä¾¿åœ¨ `form.submit` å‰åæ‰§è¡Œä¸€äº›æ“ä½œï¼Œæˆ–æ”¹å˜ `form.submit` çš„è¡Œä¸º

```ts
useAdmate({
  form: {
    proxy: {
      /**
       * @param {Function} submitForm è¢«ä»£ç†çš„åŸå§‹ submitForm
       * @returns {Promise<object> | object | void} object ä¸ºæäº¤è¡¨å•å form çš„ç»ˆæ€
       */
      submit(submitForm) {}
    }
  }
})
```

```ts
// ç¤ºä¾‹: æŒ‡å®šæäº¤å‚æ•°

form.submit({
  ...form.data,
  status: 1,
})

// form.submit è¢«ä»£ç†æ—¶
useAdmate({
  form: {
    proxy: {
      submit(submitForm) {
        return new Promise((resolve, reject) => {
          submitForm({
            ...form.data,
            status: 1,
          }).then(() => {
            resolve()
          }).catch((e) => {
            reject(e)
          })
        })
      }
    }
  }
})
```

```ts
// ç¤ºä¾‹: æäº¤å‰æ ¡éªŒè¡¨å•

useAdmate({
  form: {
    proxy: {
      submit(submitForm) {
        return new Promise((resolve, reject) => {
          formRef.value.validate().then(() => {
            submitForm().then(() => {
              resolve()
            }).catch((e) => {
              reject(e)
            })
          })
        })
      }
    }
  }
})
```

```ts
// ç¤ºä¾‹: æäº¤è¡¨å•åï¼Œè‡ªå®šä¹‰è¡¨å•çš„å¼€é—­å’Œæäº¤çŠ¶æ€

// è¿”å›ä¸€ä¸ª promise
useAdmate({
  form: {
    proxy: {
      submit(submitForm) {
        return new Promise((resolve, reject) => {
          formRef.value.validate().then(() => {
            submitForm().then(() => {
              // æäº¤æˆåŠŸåï¼Œé»˜è®¤å…³é—­è¡¨å•ï¼Œå¹¶åœæ­¢åŠ è½½
              resolve({
                show: false,
                submitting: false,
              })
            }).catch(() => {
              // æäº¤å¤±è´¥åï¼Œé»˜è®¤ä»…åœæ­¢åŠ è½½
              resolve({
                show: true,
                submitting: false,
              })
            })
          })
        })
      }
    }
  }
})

// ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ˆå¦‚æœæ²¡æœ‰å¼‚æ­¥æ“ä½œï¼‰
useAdmate({
  form: {
    proxy: {
      submit(submitForm) {
        return {
          show: false,
          submitting: false,
        }
      }
    }
  }
})
```

<br>

### æäº¤çŠ¶æ€

`form.submitting`

`axiosConfig.form.create` æˆ– `axiosConfig.form.update` è¢«è°ƒç”¨æ—¶å€¼ä¸º `true`ï¼Œå¦åˆ™ä¸º `false`

```vue
<!-- ç¤ºä¾‹ -->

<script setup>
import useAdmate from 'admate'

const { form } = useAdmate()
</script>

<template>
  <el-dialog>
    <template #footer>
      <el-button :loading="form.submitting">
        ç¡® å®š
      </el-button>
    </template>
  </el-dialog>
</template>
```

<br>

## ç”Ÿå‘½å‘¨æœŸ

### è¯»å–åˆ—è¡¨

```ts
useAdmateAdapter({}, {
  onListRead(res, trigger) {
    // res ä¸ºæ¥å£è¿”å›å€¼ï¼Œtrigger ä¸ºè°ƒç”¨åŠ¨æœº
    // å¯è®¿é—® thisï¼ˆç»„ä»¶å®ä¾‹ï¼‰
  }
})
```

<br>

### æ‰“å¼€ / è¯»å–è¡¨å•

- è¯»å–è¡¨å•å‰

```ts
watch(() => form.value.show, (n) => {
  if (n) {
    // æ‰“å¼€è¡¨å•
  }
})
```

- è¯»å–è¡¨å•å

```ts
// ç¤ºä¾‹: é€‚é…å±‚æä¾› onFormOpened

useAdmateAdapter({
  onFormOpened(res) {
    // res ä¸ºæ¥å£è¿”å›å€¼ï¼ˆæ–°å¢æ—¶ä¸ºç©ºï¼‰
    // å¯è®¿é—® thisï¼ˆç»„ä»¶å®ä¾‹ï¼‰
  }
})
```

- è¯»å–è¡¨å•å (ä¸å«æ–°å¢)

```ts
// ç¤ºä¾‹: é€‚é…å±‚æä¾› onFormRead

useAdmateAdapter({}, {
  onFormRead(res) {
    // res ä¸ºæ¥å£è¿”å›å€¼
    // å¯è®¿é—® thisï¼ˆç»„ä»¶å®ä¾‹ï¼‰
  }
})
```

<br>

### æäº¤è¡¨å•

- æäº¤è¡¨å•å‰

```ts
useAdmateAdapter({
  onFormSubmit(form) {
    // å¯è®¿é—® thisï¼ˆç»„ä»¶å®ä¾‹ï¼‰
  }
})
```

- æäº¤è¡¨å•å

```ts
useAdmateAdapter({
  onFormSubmitted(res) {
    // res ä¸ºæ¥å£è¿”å›å€¼
    // å¯è®¿é—® thisï¼ˆç»„ä»¶å®ä¾‹ï¼‰
  }
})
```

<br>

### å…³é—­è¡¨å•

```ts
watch(() => form.value.show, (n) => {
  if (!n) {
    // å…³é—­è¡¨å•
  }
})
```

<br>

## åœºæ™¯

### è¡¨å•æ˜¯å­ç»„ä»¶

> å°†è¡¨å•æŠ½ç¦»ä¸ºå­ç»„ä»¶

[ç¤ºä¾‹](https://github.com/cloydlau/admate/blob/main/demo/vue3/examples/FormExternalized.vue)

<br>

<a name="FormDecoupled"></a>

### è¡¨å•æ˜¯ç‹¬ç«‹é¡µé¢

> æ“ä½œå•æ¡è®°å½•æ—¶ï¼Œè·³è½¬åˆ°ä¸“ç”¨çš„è¡¨å•é¡µé¢ï¼Œæ“ä½œå®Œæ¯•åè¿”å›

[ç¤ºä¾‹](https://github.com/cloydlau/admate/blob/main/demo/vue3/examples/FormDecoupled.vue)

<br>

### åªæœ‰è¡¨å•æ²¡æœ‰åˆ—è¡¨

> è¡¨å•é»˜è®¤æ‰“å¼€ï¼Œä¸”æ— æ³•å…³é—­ï¼Œé€šå¸¸ç”¨äºåˆ—è¡¨ä¸­åªæœ‰ä¸€æ¡æ•°æ®ï¼Œæ•…åˆ—è¡¨è¢«çœç•¥çš„åœºæ™¯

[ç¤ºä¾‹](https://github.com/cloydlau/admate/blob/main/demo/vue3/examples/FormOnly.vue)

<br>

### åµŒå¥—ä½¿ç”¨

> å½“å‰é¡µé¢çš„å¯¹è¯æ¡†ä¹Ÿä½¿ç”¨ Admate

[ç¤ºä¾‹](https://github.com/cloydlau/admate/blob/main/demo/vue3/examples/Nested.vue)

<br>

## æ›´æ–°æ—¥å¿—

å„ç‰ˆæœ¬è¯¦ç»†æ”¹åŠ¨è¯·å‚è€ƒ [release notes](https://github.com/cloydlau/admate/releases)

<br>
